---
title: "Unit report for `r params$unit_results$uName`"
subtitle: "Generated by {composer}"
date: "`r Sys.Date()`"
output:
  html_document
    
params:
  COIN: NULL
  usel: NULL
  unit_results: NULL
  stack_children: NULL
  ulabs: NULL

always_allow_html: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.width = 8)
iname <- params$unit_results$uName
COIN <- params$COIN
usel <- params$usel

index_iCode <- get_index_code(COIN)
report_levels <- setdiff(1:COIN$Meta$maxlev, 1)

rnk <- params$unit_results$Rank
scr <- params$unit_results[[index_iCode]]

df_results <- get_results(COIN, dset = "Aggregated", tab_type = "Aggs", also_get = "uName")

```

### Index plot
```{r barchart, message=FALSE, warning=FALSE, out.width="100%"}
library(COINr)

ulabs <- if(params$ulabs == "Codes") "uCode" else "uName"
trunc_ulabs <- (params$ulabs == "Truncated names")

iCOINr::iplot_bar(
  COIN,
  dset = "Aggregated",
  iCode = index_iCode,
  usel = usel,
  ulabs = ulabs,
  stack_children = params$stack_children,
  ilabs = "iName",
  trunc_ulabs = trunc_ulabs
)
```

`r iname` is ranked `r rnk` out of `r nrow(df_results)` in the overall index. At the aggregate levels, its scores and ranks are summarised as follows:


### Unit summary table
```{r summarytable, include=T}
# get summary table
DT::datatable(
  get_unit_summary(COIN, usel = usel, Levels = report_levels, dset = "Aggregated"),
  options = list(dom = 't'), rownames = FALSE
) 
```


### Top-ranking indicators

At the indicator level, the main strengths of `r iname`, as its top five highest ranking indicators, are as follows:
    
```{r strengths}
DT::datatable({
  get_str_weak(COIN, dset = "Aggregated", usel = usel)$Strengths
}, options = list(dom = 't'), rownames = FALSE)
```
  

### Bottom-ranking indicators

In terms of rankings, the weakest five indicators are the following:
    
```{r weaknesses}
DT::datatable({
  get_str_weak(COIN, dset = "Aggregated", usel = usel)$Weaknesses
}, options = list(dom = 't'), rownames = FALSE)
```
  
